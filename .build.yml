image: archlinux
packages:
  - texlive-most
sources:
  - https://git.sr.ht/~chandlerswift/resume
secrets:
  - f79f097e-719c-40a5-8bd8-cc772ca4bf93
tasks:
  - build: |
      cd resume
      make
  - publish: |
      set +x
      cd resume
      git describe --exact-match && \
      curl \
        -H "Authorization: token `cat ~/.oauth_token`" \
        -F "file=@resume.pdf;filename=chandlerswift-`date +%F`.pdf" \
        https://git.sr.ht/api/repos/resume/artifacts/`git describe`|| true
artifacts:
  - resume/resume.pdf
